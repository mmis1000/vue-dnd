import{_ as o,M as a,p as c,q as i,N as e,V as l,a1 as u,Q as n,t as s}from"./framework-9002dd78.js";const r={},d=u(`<h1 id="native-file-support" tabindex="-1"><a class="header-anchor" href="#native-file-support" aria-hidden="true">#</a> Native file support</h1><p>Besides custom data passing between components.</p><p>Vue dnd also supports native <code>ondrop</code> events.</p><h2 id="import-nativefile-type" tabindex="-1"><a class="header-anchor" href="#import-nativefile-type" aria-hidden="true">#</a> Import <code>NativeFile</code> type</h2><p>Before we create the drop zone, we need to import the special <code>NativeFile</code> type.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> NativeFile <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@mmis1000/vue-dnd&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>This type is a special type that makes the <code>useDroppable</code> hook to receive any drop events.</p><h2 id="init-the-hook-and-handle-the-events" tabindex="-1"><a class="header-anchor" href="#init-the-hook-and-handle-the-events" aria-hidden="true">#</a> Init the hook and handle the events</h2><p>You just use this type like a regular <code>Type</code>, and handle the native event.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> propsItem<span class="token punctuation">,</span> hoverState <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useDroppable</span><span class="token punctuation">(</span>
    NativeFile<span class="token punctuation">.</span><span class="token function">withFilter</span><span class="token punctuation">(</span>ev <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>dataTransfer<span class="token operator">?.</span>types<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;Files&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token function">onDrop</span><span class="token punctuation">(</span>ev<span class="token operator">:</span> DragEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>dataTransfer<span class="token operator">?.</span>files<span class="token punctuation">.</span>length <span class="token operator">??</span> <span class="token number">0</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">const</span> file <span class="token operator">=</span> ev<span class="token punctuation">.</span>dataTransfer<span class="token operator">!</span><span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">!</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span>type<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&#39;image/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;not a image&#39;</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>image<span class="token punctuation">.</span>value <span class="token operator">!==</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
                image<span class="token punctuation">.</span>value <span class="token operator">=</span> url
                <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;a image dropped&#39;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="result" tabindex="-1"><a class="header-anchor" href="#result" aria-hidden="true">#</a> Result</h2>`,11),k=n("h2",{id:"note",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#note","aria-hidden":"true"},"#"),s(" Note")],-1),v=n("p",null,[s("This type does supports "),n("code",null,"withFilter"),s(" that accept a argument of "),n("code",null,"DragEvent"),s(", but you can't get the file content of native drop events before "),n("code",null,"ondrop"),s(" happens.")],-1),m=n("p",null,"This is a native limit and there is no way to workaround it.",-1);function h(f,b){const t=a("example-native-file-app"),p=a("example-wrapper");return c(),i("div",null,[d,e(p,{title:"example",source:"https://github.com/mmis1000/vue-dnd/blob/master/docs/src/.vuepress/components/ExampleNativeFile/App.vue"},{default:l(()=>[e(t)]),_:1}),k,v,m])}const y=o(r,[["render",h],["__file","native-file.html.vue"]]);export{y as default};
